<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h2 { color: #333; }
        .container { display: flex; gap: 50px; align-items: center; flex-wrap: wrap; justify-content: center; }
        
        /* The Input Grid */
        .grid-container { display: flex; flex-direction: column; align-items: center; }
        .grid { display: grid; grid-template-columns: repeat(3, 60px); gap: 5px; background: #333; padding: 5px; border-radius: 8px; }
        .pixel { width: 60px; height: 60px; background-color: #fff; cursor: pointer; border-radius: 4px; transition: background 0.2s; }
        .pixel.active { background-color: #000; }
        .pixel-label { font-size: 10px; color: #666; margin-bottom: 2px; }

        /* The Weights (Lines) */
        .weights-viz { position: relative; width: 150px; height: 200px; display: flex; flex-direction: column; justify-content: center; }
        .lines { width: 100%; height: 100%; position: absolute; top: 0; left: 0; pointer-events: none; }

        /* The Neuron */
        .neuron-container { display: flex; flex-direction: column; align-items: center; width: 200px; }
        .neuron { width: 80px; height: 80px; border-radius: 50%; border: 4px solid #333; display: flex; align-items: center; justify-content: center; font-weight: bold; background: #fff; transition: all 0.3s; position: relative; z-index: 2; }
        .neuron.fire { background-color: #4CAF50; color: white; border-color: #2E7D32; box-shadow: 0 0 20px #4CAF50; }
        
        /* Controls */
        .controls { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-top: 20px; width: 100%; max-width: 600px; }
        .control-row { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
        .slider-group { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .slider-item { display: flex; flex-direction: column; align-items: center; }
        input[type=range] { width: 80px; }
        
        .math-box { background: #333; color: #0f0; font-family: monospace; padding: 15px; border-radius: 5px; margin-top: 20px; width: 100%; max-width: 600px; }
    </style>
</head>
<body>

    <h2>Inside a Neuron: Weights & Biases</h2>
    <p>1. Click pixels to draw input (Black = 1, White = 0)<br>2. Adjust Weights to tell the neuron what is important.</p>

    <div class="container">
        <div class="grid-container">
            <h4>Input Image (X)</h4>
            <div class="grid" id="inputGrid">
                </div>
        </div>

        <div class="weights-viz">
            <svg class="lines" id="svgLines"></svg>
        </div>

        <div class="neuron-container">
            <h4>Neuron Output (Y)</h4>
            <div id="neuron" class="neuron">OFF</div>
            <div style="margin-top:10px; font-size: 12px;">Threshold: > 0</div>
        </div>
    </div>

    <div class="math-box" id="mathOutput">
        Calculating...
    </div>

    <div class="controls">
        <h4>The "Brain" Settings (Adjust these!)</h4>
        
        <div class="control-row">
            <label><strong>Bias</strong> (The Starting Opinion):</label>
            <input type="range" id="biasSlider" min="-5" max="5" step="0.1" value="-2">
            <span id="biasVal">-2</span>
        </div>
        <hr>
        <p style="text-align:center; font-size: 0.9em; color:#666;">Weights for each pixel (How much the neuron cares about that spot)</p>
        <div class="slider-group" id="weightSliders">
            </div>
    </div>

<script>
    const grid = document.getElementById('inputGrid');
    const weightSlidersDiv = document.getElementById('weightSliders');
    const svgLines = document.getElementById('svgLines');
    const mathOutput = document.getElementById('mathOutput');
    const neuron = document.getElementById('neuron');
    const biasSlider = document.getElementById('biasSlider');
    const biasVal = document.getElementById('biasVal');

    let inputs = [0, 0, 0, 0, 1, 0, 0, 0, 0]; // 3x3 grid
    let weights = [0, 0, 0, 0, 2, 0, 0, 0, 0]; // Initial weights to detect center dot
    let bias = -1;

    // Initialize
    function init() {
        biasSlider.value = bias;
        
        // Create Grid and Sliders
        for(let i=0; i<9; i++) {
            // Input Pixel
            let pixel = document.createElement('div');
            pixel.className = inputs[i] ? 'pixel active' : 'pixel';
            pixel.onclick = () => togglePixel(i);
            grid.appendChild(pixel);

            // Weight Slider
            let sliderItem = document.createElement('div');
            sliderItem.className = 'slider-item';
            
            let label = document.createElement('span');
            label.innerText = `Pixel ${i+1}`;
            label.style.fontSize = '10px';
            
            let slider = document.createElement('input');
            slider.type = 'range';
            slider.min = '-3';
            slider.max = '3';
            slider.step = '0.1';
            slider.value = weights[i];
            slider.oninput = (e) => updateWeight(i, e.target.value);
            
            let valDisplay = document.createElement('span');
            valDisplay.id = `w-val-${i}`;
            valDisplay.innerText = weights[i];
            valDisplay.style.fontSize = '12px';

            sliderItem.appendChild(label);
            sliderItem.appendChild(slider);
            sliderItem.appendChild(valDisplay);
            weightSlidersDiv.appendChild(sliderItem);
        }
        drawLines();
        calculate();
    }

    function togglePixel(index) {
        inputs[index] = inputs[index] === 0 ? 1 : 0;
        let pixels = document.getElementsByClassName('pixel');
        pixels[index].className = inputs[index] ? 'pixel active' : 'pixel';
        calculate();
        drawLines(); // Re-draw lines to update colors based on active input
    }

    function updateWeight(index, value) {
        weights[index] = parseFloat(value);
        document.getElementById(`w-val-${index}`).innerText = weights[index];
        calculate();
        drawLines();
    }

    biasSlider.oninput = (e) => {
        bias = parseFloat(e.target.value);
        biasVal.innerText = bias;
        calculate();
    }

    function calculate() {
        let sum = 0;
        let formulaHTML = "Sum = ";

        for(let i=0; i<9; i++) {
            let contribution = inputs[i] * weights[i];
            sum += contribution;
            
            // Only show non-zero contributions in math string to keep it clean
            if (inputs[i] === 1) {
                formulaHTML += `(${weights[i]}) + `;
            }
        }
        
        formulaHTML += `(Bias: ${bias}) = <b>${(sum + bias).toFixed(2)}</b>`;
        mathOutput.innerHTML = formulaHTML;

        let total = sum + bias;
        
        if (total > 0) {
            neuron.className = "neuron fire";
            neuron.innerText = "YES";
        } else {
            neuron.className = "neuron";
            neuron.innerText = "NO";
        }
    }

    function drawLines() {
        // Simple SVG line drawing from left to right visualization
        // Note: In a real complex 3D setup we'd use ThreeJS, but for explaining logic, 2D SVG is clearer.
        let svgContent = '';
        const startX = 0;
        const endX = 150;
        const endY = 100; // Center of neuron area

        for(let i=0; i<9; i++) {
            // Map 3x3 grid to Y coordinates roughly
            let row = Math.floor(i / 3);
            let col = i % 3;
            let startY = 20 + (row * 65) + (col * 5); // Staggered slightly

            let opacity = Math.abs(weights[i]) / 3; // Normalize opacity
            let color = weights[i] >= 0 ? 'green' : 'red';
            let width = Math.max(1, Math.abs(weights[i]) * 2);

            // If input is 0, line is dim (ghosted)
            if(inputs[i] === 0) opacity = 0.1;

            svgContent += `<line x1="${startX}" y1="${startY}" x2="${endX}" y2="${endY}" stroke="${color}" stroke-width="${width}" stroke-opacity="${opacity}" />`;
        }
        svgLines.innerHTML = svgContent;
    }

    // Handle window resize roughly
    window.onresize = drawLines;

    init();
</script>

</body>
</html>